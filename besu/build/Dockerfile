FROM hyperledger/besu:22.4.3-SNAPSHOT

# Expose offset services ports
# 8545 HTTP JSON-RPC
# 40303 P2P
EXPOSE 8545 9545 40303

USER root
RUN mkdir /besu  && chown besu:besu /besu
USER besu

ENV BESU_RPC_HTTP_APIS ADMIN,ETH,DEBUG,NET,WEB3,TXPOOL,TRACE
ENV BESU_RPC_HTTP_PORT 8545
ENV BESU_METRICS_ENABLED true
ENV BESU_METRICS_HOST 0.0.0.0
ENV BESU_P2P_PORT 40303
ENV BESU_RPC_HTTP_ENABLED true
ENV BESU_HOST_ALLOWLIST all
ENV BESU_DATA_PATH /besu


ENTRYPOINT besu $EXTRA_OPTIONS
